apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "ordino.fullname" . }}-configuration
  labels:
    {{- include "ordino.labels" . | nindent 4 }}
data:
  config.json: |-
    {
      "phovea_server": {
        "debug": {{ .Values.ordino.server.debug }},
        "port": {{ .Values.ordino.server.port }},
      },
      "tdp_core": {
        "host": "mongodb://{{ .Values.ordino.mongodb.username }}:{{ .Values.ordino.mongodb.password }}@{{ .Values.ordino.mongodb.host }}/targid{{ .Values.ordino.mongodb.extraArgs }}",
        "port": {{ .Values.ordino.mongodb.port }},
        "database": "targid"
      },
      "phovea_data_mongo": {
        "host": "mongodb://{{ .Values.ordino.mongodb.username }}:{{ .Values.ordino.mongodb.password }}@{{ .Values.ordino.mongodb.host }}/graph{{ .Values.ordino.mongodb.extraArgs }}",
        "port": {{ .Values.ordino.mongodb.port }},
        "db": "graph"
      },
      "phovea_data_redis": {
        "assigner": {
          "hostname": "{{ .Values.ordino.redis.host }}"
        },
        "mapping": {
          "hostname": "{{ .Values.ordino.redis.host }}"
        }
      },
      "tdp_publicdb": {
        "dburl": "postgresql://USER:PASS@HOST/DBNAME",
        "statement_timeout": "'5min'"
      }
    }